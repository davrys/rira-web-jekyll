<!--  -->
<section id="events">
  <div class="container">
    <div class="row">
      <div class="col-md-7 col-sm-12">
        <div class="block">

          {% assign all_events = include.all_events %}
          <div class="section-title">
            {% if all_events %}
              <h2>Historie koncertů</h2>
            {% else %}
              <h2>Koncerty</h2>
            {% endif %}
            <p></p>
          </div>

          <!-- Table style -->
          <style>
          table {
              font-family: arial, sans-serif;
              border-collapse: collapse;
              width: 100%;
          }

          td, th {
              border: 0px solid #dddddd;
              text-align: left;
              padding: 8px;
          }

          tr:nth-child(odd) {
              background-color: #eeeeee;
          }
          </style>

          <table>
            <tr style="background-color:#cccccc">
              <th>Kdy</th>
              <th></th>
              <th>Kde</th>
              <th>Co</th>
              <th>Odkaz</th>
            </tr>

            <!-- Empty row -->
            {% if all_events %}
              <tr style="background-color:#ffffff;">
                <td colspan="5"></td>
              </tr>
              {% assign last_year = event_year %}
            {% endif %}

            <!-- Sort events -->
            {% if all_events %}
              <!-- Sort events by date: descending (newest first) -->
              {% assign events = (site.data.events | sort: 'date') | reverse %}
            {% else %}
              <!-- Sort events by date: ascending (oldest first) -->
              {% assign events = (site.data.events | sort: 'date') %}
            {% endif %}

            <!-- Last displayed year -->
            {% assign last_year = 0 %}

            <!-- For each event... -->
            {% for event in events %}
                
              {% assign event_year = event.date | date: "%Y" %}
              {% assign current_year = site.time | date: "%Y" %}
              
              {% if all_events or event_year >= current_year %}

                <!-- Row with year -->
                {% if all_events and event_year != last_year %}
                  <tr style="background-color:#cccccc;">
                    <td colspan="5"><b>{{ event_year }}</b></td>
                  </tr>
                  {% assign last_year = event_year %}
                {% endif %}

                <!-- Regular row with all data -->
                <tr>
                  <td>{{ event.date | date: "%d.%m.%Y" }}</td>
                  <td>{{ event.time }}</td>
                  <td>{{ event.place }}</td>
                  <td>{{ event.name }}</td>
                  <td><a href="{{ event.url }}">{{ event.url_name }}</a></td>
                </tr>
              {% endif %}

            {% endfor %}

          </table>

          </br>
          {% unless all_events %}
            <a href="{{ site.baseurl }}{% link pages/all_events.html %}">Historie koncertů</a>
          {% endunless %}

        </div> <!-- block -->
      </div> <!-- .col-md-7 -->

    </div>
  </div>
</section>
